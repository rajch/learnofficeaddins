<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn Office Web Add-ins</title>
    <link rel="stylesheet"
        href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/9.6.1/css/fabric.min.css">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body class="ms-Fabric">
    <h1>Learn Office Web Add-ins</h1>
    <p>Add-in Running Inside</p>
    <p id="prod"></p>
    <script>
        Office.onReady(function (info) {

            var myHost = info.host;

            // if word - pages
            // if ppt - slides
            // if excel - sheets
            var addthis = ""

            switch (myHost) {
                case Office.HostType.Excel:
                    Excel.run(function (context) {
                        addthis = context.workbook.worksheets.getCount();
                        return context.sync().then(function () {
                            document.getElementById("prod").innerHTML = myHost + " - " + info.platform + " - " + addthis.value + " sheets"
                            // 
                        });
                    })
                    break;
                case Office.HostType.Word:
                    Word.run(function (context) {
                        var paracoll = context.document.body.paragraphs
                        paracoll.load("items")
                        return context.sync().then(function () {
                            document.getElementById("prod").innerHTML = myHost + " - " + info.platform + " - " + paracoll.items.length + " paragraphs"
                            // 
                        });
                    })
                    break;
                default:
                    addthis = "nothing to do"
                    document.getElementById("prod").innerHTML = myHost + " - " + info.platform + addthis;
                    break;
            }



            /*
            
            
            if (info.host === Office.HostType.Excel) {
                // Do Excel-specific initialization (for example, make add-in task pane's
                // appearance compatible with Excel "green").
            }
            if (info.platform === Office.PlatformType.PC) {
                // Make minor layout changes in the task pane.
            }
            */
            console.log(`Office.js is now ready in ${info.host} on ${info.platform}`);
        });
    </script>
</body>

</html>